(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _constants=require('./constants');function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var Cell=function(){function Cell(x,y,clickHandle){var _this=this;_classCallCheck(this,Cell);this.x=x;this.y=y;this.id='cell_'+x+'_'+y;this.color=_constants.COLORS.cell[x%2===y%2];this.checker=null;this.cellDOM=function(){var cell=document.createElement('div');cell.id=_this.id;cell.className='cell cell__'+_this.color;cell.style.width=_constants.WH+'%';cell.style.height=_constants.WH+'%';cell.addEventListener('click',clickHandle.bind(_this));if(!cell.hasOwnProperty('obj')){cell.obj=_this}return cell}()}// public methods
_createClass(Cell,[{key:'getPosition',value:function getPosition(){return{x:this.x,y:this.y}}},{key:'containChecker',value:function containChecker(checker){this.checker=checker}},{key:'hasChecker',value:function hasChecker(){return this.checker!=null}},{key:'removeChecker',value:function removeChecker(){if(this.checker){this.cellDOM.removeChild(this.checker.checkerDOM);this.checker=null}}},{key:'highlight',value:function highlight(){this.cellDOM.classList.toggle('highlight')}},{key:'unhighlight',value:function unhighlight(){this.cellDOM.classList.remove('highlight')}},{key:'isHighlighted',value:function isHighlighted(){return this.cellDOM.classList.contains('highlight')}}]);return Cell}();exports.default=Cell;

},{"./constants":3}],2:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var Checker=function(){function Checker(color,clickHandle){var _this=this;_classCallCheck(this,Checker);this.color=color;this.cell=null;this.checkerDOM=function(){var checker=document.createElement('div');checker.className='checker checker__'+_this.color;if(!checker.hasOwnProperty('obj')){checker.obj=_this}checker.addEventListener('click',clickHandle.bind(_this));return checker}()}// public methods
_createClass(Checker,[{key:'activate',value:function activate(){this.checkerDOM.classList.toggle('active')}},{key:'belongsTo',value:function belongsTo(cell){this.cell=cell;if(cell){cell.cellDOM.appendChild(this.checkerDOM)}}},{key:'canTurn',value:function canTurn(currentTurn){return this.color===currentTurn}},{key:'mark',value:function mark(){this.checkerDOM.classList.toggle('marked')}},{key:'unmark',value:function unmark(){this.checkerDOM.classList.remove('marked')}},{key:'isMarked',value:function isMarked(){return this.checkerDOM.classList.contains('marked')}},{key:'isMovePossible',value:function isMovePossible(currentChecker,currentTurn){return this.canTurn(currentTurn)&&this.isMarked()&&(currentChecker==null||currentChecker!==this)}},{key:'moveTo',value:function moveTo(cell){this.cell.removeChecker();this.belongsTo(cell);cell.containChecker(this)}}]);return Checker}();exports.default=Checker;

},{}],3:[function(require,module,exports){
'use strict';Object.defineProperty(exports,'__esModule',{value:true});var N=exports.N=8;var WH=exports.WH=100/N;var TOP_UP=exports.TOP_UP=4;var BOTTOM_FROM=exports.BOTTOM_FROM=N-3;var BG_COLORS=exports.BG_COLORS={red:'#ff0000',blue:'#0000ff'};var COLORS=exports.COLORS={checker:{light:'red',dark:'blue'},cell:{true:'black',false:'white'}};

},{}],4:[function(require,module,exports){
'use strict';var _constants=require('./constants');var _Cell=require('./Cell');var _Cell2=_interopRequireDefault(_Cell);var _Checker=require('./Checker');var _Checker2=_interopRequireDefault(_Checker);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function Checkers(){var _moves;var self=this;this.N=_constants.N;this.TURNS=[_constants.COLORS.checker.light,_constants.COLORS.checker.dark];this.EAT_MOVE='eat';this.FREE_MOVE='free';// 0 - light, 1 - dark
this.currentTurn=this.TURNS[0];this.turnsCount=0;this.currentChecker=null;this.boardDOM=document.getElementById('board');this.turnsCountDOM=document.getElementById('turns_count');this.turnColorDOM=document.getElementById('current_turn_color');this.getCell=function(x,y){var cell=document.getElementById('cell_'+x+'_'+y);return cell?cell.obj:null};this.getCheckers=function(color){var marked=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var checkers=document.querySelectorAll('.checker.checker__'+color+(marked?'.marked':''));checkers=Object.keys(checkers).map(function(i){return checkers[i]=checkers[i].obj});return checkers};var gameController={LEFT:0,RIGHT:1,moves:(_moves={},_defineProperty(_moves,_constants.COLORS.checker.light,{fw:[{x:-1,y:-1},{x:-1,y:1}],bw:[{x:1,y:-1},{x:1,y:1}]}),_defineProperty(_moves,_constants.COLORS.checker.dark,{fw:[{x:1,y:-1},{x:1,y:1}],bw:[{x:-1,y:-1},{x:-1,y:1}]}),_moves),showMoves:function showMoves(moves){if(moves){moves.forEach(function(move){if(move&&move.cell){move.cell.highlight()}})}},getAvailableMoves:function getAvailableMoves(checker){var onlyEat=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var checkerMoves=this.moves[checker.color];var enemyEatingFilter=function enemyEatingFilter(mv){return mv&&mv.cell&&mv.type===self.EAT_MOVE};var freeMoveFilter=function freeMoveFilter(mv){return mv&&mv.cell&&mv.type===self.FREE_MOVE};var moves=[];moves.push(this.getAvailableCell(checker,checkerMoves.fw[this.LEFT],onlyEat),this.getAvailableCell(checker,checkerMoves.fw[this.RIGHT],onlyEat),this.getAvailableCell(checker,checkerMoves.bw[this.LEFT],true),this.getAvailableCell(checker,checkerMoves.bw[this.RIGHT],true));if(moves.some(enemyEatingFilter)){moves={type:self.EAT_MOVE,moves:moves.filter(enemyEatingFilter)}}else{moves={type:self.FREE_MOVE,moves:moves.filter(freeMoveFilter)}}return moves.moves.length?moves:null},getAvailableCell:function getAvailableCell(checker,direction){var onlyEat=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var curPos=checker.cell.getPosition();var cell=self.getCell(curPos.x+direction.x,curPos.y+direction.y);var cellHasChecker=cell&&cell.hasChecker();if(!cellHasChecker&&!onlyEat){return{type:self.FREE_MOVE,cell:cell}}if(cellHasChecker&&checker.color!==cell.checker.color){return{type:self.EAT_MOVE,cell:this.cellAfterEating(cell.getPosition(),direction)}}return null},cellAfterEating:function cellAfterEating(enemyPosition,dirPosition){var cell=self.getCell(enemyPosition.x+dirPosition.x,enemyPosition.y+dirPosition.y);return cell&&!cell.hasChecker()?cell:null},eatIfItPossible:function eatIfItPossible(curCell,nextCell){if(Math.abs(curCell.x-nextCell.x)===2){var direction=this.calcDirectionOfMove(curCell,nextCell);var enemyCell=self.getCell(curCell.x+direction.x,curCell.y+direction.y);enemyCell.checker.belongsTo(null);enemyCell.removeChecker();return true}return false},calcDirectionOfMove:function calcDirectionOfMove(curCell,nextCell){return{x:(nextCell.x-curCell.x)/2,y:(nextCell.y-curCell.y)/2}},markAvailableCheckers:function markAvailableCheckers(color){var _this=this;var checkers=self.getCheckers(color);var eatMoves=false;var freeMoves=[];checkers.forEach(function(checker){var moves=_this.getAvailableMoves(checker);if(moves){if(moves.type===self.EAT_MOVE){checker.mark();eatMoves=true}else{freeMoves.push(checker)}}});if(!eatMoves&&freeMoves.length){freeMoves.forEach(function(checker){return checker.mark()})}},unmarkCurrentCheckers:function unmarkCurrentCheckers(color){var checkers=self.getCheckers(color,true);checkers.forEach(function(checker){return checker.unmark()})},setNexnTurn:function setNexnTurn(){self.turnsCount++;self.currentTurn=self.TURNS[self.turnsCount%2]}};function deactivateCheckers(){var activeCheckers=document.getElementsByClassName('checker active');if(activeCheckers.length){Object.keys(activeCheckers).map(function(i){return activeCheckers[i].classList.remove('active')});var highlights=document.querySelectorAll('.cell.highlight');Object.keys(highlights).map(function(i){return highlights[i].obj.unhighlight()})}}function checkerClickHandle(e){var checker=this;deactivateCheckers();if(checker!==undefined&&checker.isMovePossible(self.currentChecker,self.currentTurn)){var availableMoves=gameController.getAvailableMoves(checker);checker.activate();gameController.showMoves(availableMoves.moves);self.currentChecker=checker}else{self.currentChecker=null}return false}function cellClickHandle(e){var cell=this;if(self.currentChecker&&cell.isHighlighted()){// console.log('can move to this cell')
var wasEaten=gameController.eatIfItPossible(self.currentChecker.cell,cell);self.currentChecker.moveTo(cell);var mustEat=gameController.getAvailableMoves(self.currentChecker,true);deactivateCheckers();if(wasEaten&&mustEat&&mustEat.moves){self.currentChecker.activate();gameController.showMoves(mustEat.moves)}else{gameController.unmarkCurrentCheckers(self.currentTurn);gameController.setNexnTurn();gameController.markAvailableCheckers(self.currentTurn)}updateInfo()}else{// console.log('move to this cell is impossible')
}return false}// drawing board
function drawBoard(){for(var i=1;i<=self.N;i++){for(var j=1;j<=self.N;j++){var cell=new _Cell2.default(i,j,cellClickHandle);self.boardDOM.appendChild(cell.cellDOM);drawChecker(cell)}}}function drawChecker(cell){if(cell.y%2===cell.x%2&&(cell.x<_constants.TOP_UP||cell.x>_constants.BOTTOM_FROM)){var checkerColor=cell.x<_constants.TOP_UP?_constants.COLORS.checker.dark:_constants.COLORS.checker.light;var checker=new _Checker2.default(checkerColor,checkerClickHandle);checker.belongsTo(cell);cell.containChecker(checker)}}function updateInfo(){self.turnsCountDOM.textContent=self.turnsCount;self.turnColorDOM.style.backgroundColor=_constants.BG_COLORS[self.currentTurn]}// testing functions
function testCheckers(checkerColor,cells){cells.forEach(function(cell){var testChecker=new _Checker2.default(checkerColor,checkerClickHandle);var testCell=document.getElementById('cell_'+cell.x+'_'+cell.y).obj;testChecker.belongsTo(testCell);testCell.containChecker(testChecker)})}function deleteChecker(x,y){var cell=document.getElementById('cell_'+x+'_'+y).obj;if(!cell||!cell.checker)return false;cell.removeChecker();return true}// init
drawBoard();updateInfo();// TEST
// testCheckers(COLORS.checker.dark, [{x: 5, y: 5}, {x: 5, y: 3}])
// deleteChecker(6, 4)
// deleteChecker(6, 6)
// MARK
gameController.markAvailableCheckers(self.currentTurn)}Checkers.init=function(){window.checkers=new Checkers};Checkers.init();

},{"./Cell":1,"./Checker":2,"./constants":3}]},{},[4])